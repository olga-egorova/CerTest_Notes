---
title: "Cantilever beam example"
output: html_notebook
---

Toy example. Cantilever beam

We consider here a 3-layer beam with 2 interfaces, clamped at one end, with no extra load -- just gravity.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("/Users/olga/work/CerTest/output/pyComp/")) # set the wd
```

```{r include=FALSE, echo = FALSE}
library(data.table)
library(ggplot2)
```

Read the FE "grid" data, that has been obtained from running the forward model on the grid of defect parameters -- $(\theta_1, \theta_2, \theta_3)$:

```{r}
df_displacements = data.table(read.table("output_grid_pi30.csv", header = T, sep=","))
df_theta = data.table(read.table("theta_grid_pi30.csv", header = T, sep = ","))
summary(df_displacements)

df_data = cbind(df_theta, df_displacements)
NDataPoints = ncol(df_displacements)
NGrid = nrow(df_displacements)
```

First, look at the modelled displacements:
```{r include=TRUE}
summary(df_displacements)

plotly::plot_ly(df_theta, x = ~theta_1, y = ~theta_2, z = ~theta_3, color = ~df_displacements$D10)
```

Data generation. We start with assuming normal independent errors with zero mean and variance $\sigma^2_e$. 
Add these errors to the modelled displacements, and evaluate the likelihood function of the generated data as minimised misift:
$$\exp(-\delta)$$